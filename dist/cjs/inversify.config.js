"use strict";require("reflect-metadata");var e=require("./core.config.js"),n=require("./app.js"),i=require("./utils/graceful-exit.js"),t=require("./utils/inversify-adapter.js"),r=require("./utils/global-middlewares.js"),o=require("inversify"),s=require("./config/logger.js"),a=require("./config/server.js"),c=require("./config/db.js"),S=require("./config/redis.js"),l=require("./config/session.js"),u=require("./types/constants.js");class g{static register(){this.container.bind(u.SYMBOLS.Config).toDynamicValue(async()=>await(new e.CoreConfig).loadConfig()).inSingletonScope(),this.container.bind(u.SYMBOLS.Logger).toConstantValue(s),this.container.bind(u.SYMBOLS.IocAdapter).toConstantValue(new t(this.container)),this.container.bind(u.SYMBOLS.DataSource).toResolvedValue(e=>{const{db:n}=e;return c(n)},[u.SYMBOLS.Config]).inSingletonScope(),this.container.bind(u.SYMBOLS.Redis).toResolvedValue(e=>{const{redis:n}=e;return S(n)},[u.SYMBOLS.Config]).inSingletonScope(),this.container.bind(u.SYMBOLS.CreateSession).toResolvedValue(e=>{const{session:n}=e;return new l(n.client)},[u.SYMBOLS.Config]).inSingletonScope(),this.container.bind(u.SYMBOLS.CreateServer).toProvider(e=>{let n;const i=e.get(u.SYMBOLS.IocAdapter);return async t=>{const{router:r}=await e.getAsync(u.SYMBOLS.Config);return n||(n=new a(r,i,t)),n}}),this.container.bind(u.SYMBOLS.GracefulExit).toResolvedValue(e=>new i(e),[u.SYMBOLS.Logger]).inSingletonScope(),this.container.bind(u.SYMBOLS.GlobalMiddlewares).to(r).inSingletonScope(),this.container.bind(u.SYMBOLS.App).to(n.App)}static async getApp(){return await this.container.getAsync(u.SYMBOLS.App)}}g.container=new o.Container,g.register(),exports.DI=g;
//# sourceMappingURL=inversify.config.js.map
